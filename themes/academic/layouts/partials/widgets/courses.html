{{ $ := .root }}
{{ $page := .page }}
{{ $autolink := default true $page.Params.autolink }}
{{ $data := site.Params }}

<!-- Contact widget -->
<div class="row contact-widget">
        <!--<div class="col-12 col-lg-4 section-heading">-->
  <div class="col-lg-12">
    <h1>{{ with $page.Title }}{{ . | markdownify }}{{ end }}</h1>
    {{ with $page.Params.subtitle }}<p>{{ . | markdownify }}</p>{{ end }}
  <!--</div>-->
  <!--<div class="col-12 col-lg-8">-->
    {{ with $page.Content }}{{ . }}{{ end }}

    <div class="mb-3">

  <script>
  function createGitHubIssue(title, code, university, contact_name, contact_email, 
  						   webpage, country, level) {
  
  	// instead of getting concepts & tools by value, we get them directly
  	var concepts_list = $('input[name="concepts"]:checked').map(function() {
      	return $(this).val();
    	}).get()
  
  	var tools_list = $('input[name="tools"]:checked').map(function() {
      	return $(this).val();
    	}).get()
  
    contact_part = contact_name.value;
    if (contact_email.value) {
      contact_part = contact_part + ", " + contact_email.value; 
    }
  	link = "https://github.com/fme-teaching/fm-courses/issues/new?labels=" +
  				country.value + 
  				"&title=" + title.value + "&body=" +
                  "Course code, if applicable: " + code.value + "%0A" + 
                  "University hosting the course: "+ university.value + "%0A" + 
                  "Contact person: " + contact_part + "%0A" +
                  "Concepts taught: " + concepts_list + "%0A" + 
                  "Tools used: " + tools_list + "%0A" + 
                  "Webpage: " + webpage.value + "%0A" + 
                  "Year/Level: " + level.value + "%0A";
  	window.open(link);
  }
  </script>

  <style>
    ul.fme-form-checkbox li {
      display: inline-block;
      border: 1px transparent solid; 
      width: 16em;
    }
  </style>

  <form onsubmit="createGitHubIssue(title, code, university, contact_name,
        contact_email, webpage, country, level, concepts)">


        <div class="form-group form-inline">
          <label class="sr-only" for="c_name">Course name</label>
          <input type="text" name="title" class="form-control w-100"
                 id="c_name" placeholder="Course name" required>
        </div>

        <div class="form-group form-inline">
          <label class="sr-only" for="c_code">Course code, if applicable</label>
          <input type="text" name="code" class="form-control w-100" id="c_code"
                 placeholder="Course code, if applicable">
        </div>

        <div class="form-group form-inline">
          <label class="sr-only" for="c_university">
            University hosting the course
          </label>
          <input type="text" name="university" class="form-control w-100"
                 id="c_university" 
                 placeholder="University hosting the course" required>
        </div>

        <div class="form-group form-inline">
          <label for="list-countries">Country</label>
          <select id="list-countries" name="country" class="form-control w-100">
          </select>
        </div>

        <div class="form-group form-inline">
          <label for="list-levels">Year/Level</label>
          <select id="list-levels" name="level" class="form-control w-100">
		    <option value="1">1</option>
		    <option value="2">2</option>
		    <option value="3">3</option>
		    <option value="4">4</option>
		    <option value="MSc">MSc</option>
		    <option value="PhD">PhD</option>
		    <option value="Unknown">Other</option>
          </select>
        </div>

        <div class="form-group form-inline">
          <label class="sr-only" for="c_webpage">
            Course webpage
          </label>
          <input type="text" name="webpage" class="form-control w-100"
                 id="c_webpage" 
                 placeholder="Course webpage">
        </div>

        <div class="form-group form-inline">
          <label class="sr-only" for="p_name">
            Contact person's name
          </label>
          <input type="text" name="contact_name" class="form-control w-100"
                 id="p_name" 
                 placeholder="Contact person's name">
        </div>

        <div class="form-group form-inline">
          <label class="sr-only" for="p_email">
            Contact person's email
          </label>
          <input type="text" name="contact_email" class="form-control w-100"
                 id="p_email" 
                 placeholder="Contact person's email">
        </div>

        <div class="form-group form-inline">
          <label for="c_concepts">
            Concepts taught
          </label>
          <ul class="fme-form-checkbox" id="list-concepts">
          <li>
		  <input class="form-control" type="checkbox" name="concepts" 
                 value="Abstract Interpretation">
            Abstract Interpretation
          </input>
          </li>
        </div>

        <div class="form-group form-inline">
          <label for="c_tools">
            Tools used
          </label>
          <ul class="fme-form-checkbox" id="list-tools">
          <li>
		  <input class="form-control" type="checkbox" name="tools" 
                 value="Coq">
            Coq
          </input>
          </li>
          </ul>
        </div>

    <div class="row">
      <button type="submit" class="btn btn-outline-primary px-3 py-2">Submit</button>
    </div>
  </form>



    </div>

  </div>
</div>
